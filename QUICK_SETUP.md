# Quick Setup - Copy & Paste Ready ğŸš€

This file contains everything you need to copy and paste for your password reset flow.

---

## 1ï¸âƒ£ Supabase Email Template

**Go to:** Supabase Dashboard â†’ Authentication â†’ Email Templates â†’ "Reset Password"

### Subject:
```
Reset your password for ParkSafe
```

### Template Body (Copy this entire block):

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">
    <table role="presentation" style="width: 100%; border-collapse: collapse;">
        <tr>
            <td align="center" style="padding: 40px 0;">
                <table role="presentation" style="width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 8px;">
                    <tr>
                        <td style="padding: 40px 40px 20px 40px; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px 8px 0 0;">
                            <h1 style="margin: 0; color: #ffffff; font-size: 28px;">ğŸ” Password Reset</h1>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 40px;">
                            <p style="margin: 0 0 20px 0; font-size: 16px; color: #333;">Hi there,</p>
                            <p style="margin: 0 0 20px 0; font-size: 16px; color: #333;">We received a request to reset your password. Click the button below:</p>
                            <table role="presentation" style="width: 100%; margin: 30px 0;">
                                <tr>
                                    <td align="center">
                                        <a href="{{ .ConfirmationURL }}" style="display: inline-block; padding: 16px 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #ffffff; text-decoration: none; border-radius: 6px; font-weight: 600;">Reset My Password</a>
                                    </td>
                                </tr>
                            </table>
                            <p style="margin: 20px 0; font-size: 14px; color: #666;">Or copy this link:</p>
                            <p style="margin: 0 0 20px 0; padding: 12px; background-color: #f8f8f8; border-radius: 4px; font-size: 12px; word-break: break-all; color: #666;">{{ .ConfirmationURL }}</p>
                            <div style="margin: 30px 0 0 0; padding: 20px; background-color: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                                <p style="margin: 0; font-size: 14px; color: #856404;"><strong>âš ï¸ Security Notice:</strong><br>If you didn't request this, ignore this email.</p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 30px 40px; background-color: #f8f8f8; border-radius: 0 0 8px 8px;">
                            <p style="margin: 0; font-size: 12px; color: #999; text-align: center;">Â© 2026 ParkSafe | {{ .Email }}</p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
```

---

## 2ï¸âƒ£ Supabase Redirect URLs

**Go to:** Supabase Dashboard â†’ Authentication â†’ URL Configuration â†’ Redirect URLs

**Add these URLs:**

```
http://localhost:3000/reset-password
https://parksafe.hu/reset-password
```

---

## 3ï¸âƒ£ Add "Forgot Password" Link to Login Page

Add this to your login page:

```tsx
<a 
  href="/forgot-password"
  className="text-sm font-medium text-indigo-600 hover:text-indigo-500"
>
  Forgot your password?
</a>
```

---

## 4ï¸âƒ£ Test the Flow

Run these commands:

```bash
# Make sure dev server is running
npm run dev
```

Then:
1. Go to `http://localhost:3000/forgot-password`
2. Enter your email
3. Check your email inbox
4. Click the reset link
5. Enter new password
6. Login with new password!

---

## âœ… What You Have Now

- âœ… `/forgot-password` page - Request reset
- âœ… `/reset-password` page - Set new password
- âœ… Secure token-based system
- âœ… No auto-login (requires password entry)
- âœ… Email template with nice design
- âœ… Auth context functions ready

---

## ğŸ¯ URL Format You Wanted

The email will contain:
```
https://parksafe.hu/reset-password?token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

The token is:
- âœ… Automatically generated by Supabase
- âœ… Secure and encrypted
- âœ… Time-limited (expires in 1 hour)
- âœ… Single-use only
- âœ… Requires user to enter new password (no auto-login!)

---

## ğŸ› Troubleshooting

**No email received?**
- Check spam folder
- Check Supabase Dashboard â†’ Authentication â†’ Logs
- Verify email settings in Supabase

**"Invalid token" error?**
- Link may have expired (1 hour limit)
- Request a new reset link
- Check redirect URLs are configured

**User auto-logged in?**
- This issue is now fixed!
- We updated `AuthRedirectHandler.tsx` to ignore password recovery links
- We updated the reset page to handle the session correctly
- The user will stay on the reset page until they update their password

---

That's it! Everything is ready to go. ğŸ‰
